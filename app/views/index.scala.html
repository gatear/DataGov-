@(assetsFinder: AssetsFinder)
<html>
<head>
    <meta charset="utf-8">
    <title>Crime Data</title>

        <!-- Awesome Fonts-->
    <link href="@assetsFinder.path("css/fontawesome-free-5.0.2/web-fonts-with-css/css/fontawesome-all.css")"  rel="stylesheet" >

        <!-- Bootstrap -->
    <link href="@assetsFinder.path("css/bootstrap.min.css")" rel="stylesheet">

        <!--jVectorMap-->
    <link href="@assetsFinder.path("css/jquery-jvectormap-2.0.3.css")">

        <!--DataTables -->
    <link href="@routes.Assets.versioned("dataTables/css/dataTables.responsive.css")" rel="stylesheet">
    <link href="@assetsFinder.path("dataTables/css/dataTables.bootstrap4.min.css")" rel="stylesheet">

        <!-- Custom CSS-->
    <link href="@assetsFinder.path("css/scrolling-nav.css")" rel="stylesheet">

</head>
<body>

@layout("body")



        <!-- Bootstrap core JavaScript -->
    <script src="@assetsFinder.path("js/jquery.min.js")"></script>
    <script src="@assetsFinder.path("js/tether.min.js")"></script>
    <script src="@assetsFinder.path("js/bootstrap.bundle.min.js")"></script>

        <!-- Plugin JavaScript -->
    <script src="@assetsFinder.path("js/jquery.easing.min.js")"></script>

        <!-- Custom JavaScript for this theme -->
    <script src="@assetsFinder.path("js/scrolling-nav.js")"></script>
        <!--jVectorMap -->
    <script src="@assetsFinder.path("js/jquery-jvectormap-2.0.3.min.js")"></script>
    <script src="@assetsFinder.path("js/chicago-mill.js")"></script>

        <!-- ChartJS -->
    <script src="@assetsFinder.path("js/chart.bundle.min.js")"></script>
    <script src="@assetsFinder.path("assets/charts.js")"></script>

        <!-- DataTablesJS -->
    <script src="@assetsFinder.path("dataTables/js/jquery.dataTables.min.js")"></script>
    <script src="@assetsFinder.path("dataTables/js/dataTables.responsive.js")"></script>
    <script src="@assetsFinder.path("dataTables/js/dataTables.bootstrap4.min.js")"></script>
    <script>
                    $(document).ready(function() {
                        var modalTable = $('#modalTable').DataTable( { responsive: true } );
                        var long = $('#long');
                        var lat = $('#lat');
                        var searchPath;
                        var showResults = $("#showResults");
                        var input = $('#input-group');

                        var map, markerIndex = 0, markersCoords = {};

                        map = new jvm.Map({
                            map: 'us-il-chicago_mill',
                            markerStyle: {
                                initial: {
                                    fill: 'red'
                                }
                            },
                            container: $('#chicago'),
                            onMarkerTipShow: function(e, label, code){
                                map.tip.text(markersCoords[code].lat.toFixed(2)+', '+markersCoords[code].lng.toFixed(2));
                            },
                            onMarkerClick: function(e, code){
                                map.removeMarkers([code]);
                                map.tip.hide();
                            }
                        });

                        map.container.click(function(e){
                            var latLng = map.pointToLatLng(
                                    e.pageX - map.container.offset().left,
                                    e.pageY - map.container.offset().top
                                    ),
                                    targetCls = $(e.target).attr('class');
                            long.val(latLng.lng);
                            lat.val(latLng.lat);
                            searchPath = "/location/"+ long.val() +"/"+ lat.val();


                            console.log(searchPath);

                            $.get(searchPath).done(function (data) {
                                modalTable.clear();
                                showResults.prop("disabled",true);

                                data.length != 0 ? input.append('<div class="alert alert-success  alert-dismissible">\n' + ' <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n' +
                                        '    <span aria-hidden="true">&times;</span>\n' +
                                        '  </button> <strong>Success!</strong> Incidents for selected area found!\n' + '</div>')
                                                 : input.append('<div class="alert alert-warning  alert-dismissible">\n' + '  <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n' +
                                        '    <span aria-hidden="true">&times;</span>\n' +
                                        '  </button><strong>Nothing!</strong> Incidents for selected area were not found!\n' + '</div>');

                                for(var i=0;i < data.length; i++)

                                {
                                    modalTable.row.add([data[i].ID,
                                        data[i].Crime,
                                        data[i].Description,
                                        data[i].LocationDescription,
                                        data[i].Date]);
                                    modalTable.draw();

                                    showResults.prop("disabled",false);
                                }

                            })

                            if (latLng && (!targetCls || (targetCls && $(e.target).attr('class').indexOf('jvectormap-marker') === -1))) {
                                markersCoords[markerIndex] = latLng;
                                map.addMarker(markerIndex, {latLng: [latLng.lat, latLng.lng]});
                                markerIndex += 1;
                            }
                        });
                    } );

            </script>
</body>
</html>